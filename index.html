<!DOCTYPE html>
  <head>
    <title>bronen.github.io</title>
    <meta charset="utf-8" />
    <link rel="icon" href="/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#202020" />

    <style>
      body{
        padding: 1vh 1vw;
        background-color: #101010;
      }
      *{
        box-sizing: border-box;
      }
      header{
        color: #505050;
        padding: 20px;
        margin-bottom: 0px;
        background-color: #0a0a0a;
        border-bottom: 0px;
        border-radius: 10px;
        display: flex;
        align-items: stretch;
        justify-content: space-between;
      }
      .header_button{
        padding: 0px 15px;
        background-color: #111;
        border-radius: 10px;
        box-shadow: 0px 0px 10px #000 inset;
      }
      #profile_img{
        width: auto;
        max-height: 10vh;
        min-height: 100%;
        margin: 5px;
        border-radius: 100%;
        border:2px solid #aaa;
        transition-property: transform;
        transition-duration: 2s;
      }
      #profile_img:hover{
        box-shadow: 0 0 6px 1px rgba(0, 140, 186, 0.8);
        transform: rotateZ(360deg);
      }
      #root{
        color: #5d5;
        text-shadow: 2px 1px 4px #000;
        padding: 20px;
        margin: 10px;
        margin-top: 0px;
        background-color: #0b0b0b;
        border-top: -5px;
        border-radius: 0px 0px 10px 10px;
        box-shadow: 0px 4px 10px #000 inset;
        display: flex;
        overflow: hidden;
        scroll:hidden;
        overflow-y: auto;
      }
      #labels{
        background-color: #0b0b0b;
        display: flex;
        flex-direction: column;
        overflow-y: auto;
        border-radius: 10px;
        padding: 10px;
        margin-top: 10px;
        margin-right: 15px;
      }
      #labels *{
        padding: 15px;
        font-size: 90%;
        margin-bottom: 10px;
        width: 100%;
        cursor: pointer;
        border-radius: 20px;
        box-shadow: 1px 1px 2px #666;
        border:1px solid #aaa;
        background: #222;
        color: #5b5;
      }
      #posts{
        width: 90%;
      }
      .link_post{
        white-space: wrap;
        text-overflow: clip;
        overflow: hidden;
        margin-top: 20px;
        max-height: 45vh;
        padding: 10px;
        box-shadow: 0px 0px 30px #1d1d1d inset;
        border:1px solid #aaa;
        border-radius: 20px;
        background-color: #101010;
      }
      .link_post:hover{
        box-shadow: 0px 0px 15px rgba(0, 140, 186, 0.8) inset;
        border: 1px solid #aad;
      }
      .link_post *{
        border-radius: 20px;
        text-overflow: ellipsis;
      }
      .link_post h1{
        box-shadow: 0px 0px 10px #111;
        background-color: #191919;
        color: #5b5;
      }
      a{
        text-decoration: none;
        color: #5b5;
      }
      .link_title{
        padding: 10px;
      }
      ::-webkit-scrollbar {
        width: 10px;

      }
      ::-webkit-scrollbar-track {
        box-shadow: 1px 1px 2px #000 inset;
        border-radius: 10px;
        background: #222;
      }
      ::-webkit-scrollbar-thumb {
        background: #101010;
        border-radius: 20px;
      }
      @media (max-width: 600px){
        #root{
          flex-direction: column-reverse;
        }
        #labels{
          margin-right: 0px;
        }
        #labels *{
          width: auto;
        }
        #posts{
          width: 100%;
        }
      }
    </style>
    <script>

      const State = {};

      State.Profile = {};

      State.Profile.User = {};
      State.Profile.setUser = function(newUser){
        State.Profile.User = newUser;
        console.log("Defined User");
      };

      State.Profile.Repos = {};
      State.Profile.setRepos = function(newRepos){
        State.Profile.Repos = newRepos;
        console.log("Defined Repos");
      };

      State.posts = [];

      window.addEventListener('load', init);

      function postsByLabels(label){
        axios.get(`https://api.github.com/repos/BRonen/bronen.github.io/issues?labels=${label}`, {
          headers: {
            'content-type': 'application/json'
          }
        } ).then(response => {
          console.log(response)
          let tmpHTML = '';
          response.data.map(post => {
            tmpHTML += `<a href="/post.html?post=${post.number}">
                          <div class="link_post">
                            <center><h1 class="link_title">${post.title}</h1></center>
                            <p>${post.body}</p>
                          </div>
                        </a>`;
          });
          document.getElementById('posts').innerHTML = tmpHTML;
        });
      }

      function init(){
        axios.get('https://api.github.com/users/BRonen', {
          headers: {
            'content-type': 'application/json'
          }
        } ).then(response => {
          const User = response.data;
          console.log(User);
          State.Profile.setUser(User);

          axios.get(User.repos_url, {
            headers: {
              'content-type': 'application/json'
            }
          } ).then(response => {
            const Repos = response.data;
            console.log(Repos);
            State.Profile.setRepos(Repos);

            setupDom();
          });
        });
      }

      function setupDom(){
        document.getElementById('profile_img').src = State.Profile.User.avatar_url;

        axios.get('https://api.github.com/repos/BRonen/bronen.github.io/labels', {
          headers: {
            'content-type': 'application/json'
          }
        } ).then(response => {
          let tmpHTML = '';

          response.data.map(label => {
            tmpHTML += `<button onClick="postsByLabels('${label.name}')">${label.name}</button>`
          });

          document.getElementById('labels').innerHTML = tmpHTML;
        });

        axios.get('https://api.github.com/repos/BRonen/bronen.github.io/issues?per_page=10', {
          headers: {
            'content-type': 'application/json'
          }
        } ).then(response => {
          console.log(response)
          let tmpHTML = '';
          response.data.map(post => {
            tmpHTML += `<a href="/post.html?post=${post.number}">
                          <div class="link_post">
                            <center><h1>${post.title}</h1></center>
                            <p>${post.body}</p>
                          </div>
                        </a>`;
          });
          document.getElementById('posts').innerHTML = tmpHTML;
        });
      }

    </script>
  </head>
  <body>
    <header>
      <img id="profile_img" src=""/>
      <a  class="header_button" href="/aboutme.html"><h1>About Me</h1></a>
    </header>
    <div id="root">
      <aside id="labels"></aside>
      <div id="posts"></div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  </body>
</html>
